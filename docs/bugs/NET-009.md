# NET-009: JsonLinesFormat Option Had No Effect

## Status: ✅ Fixed (v1.2.1)

## Summary
`JsonWriteOptions.JsonLinesFormat = true` had no effect on 3 of 6 WriteJson overloads. They always produced a standard JSON array instead of NDJSON (one object per line).

## Impact
**Medium** — Users calling `data.WriteJson("out.jsonl", opts)` with `JsonLinesFormat = true` got a JSON array instead of JSONL format. Documented behavior promised NDJSON output.

## Root Cause
Three `IEnumerable<T>` overloads in `Writers.cs` used `JsonSerializer.Serialize/SerializeAsync` directly, bypassing the `options.JsonLinesFormat` check:
1. `WriteJsonSync<T>(IEnumerable<T>, string path)` — sync file path
2. `WriteJson<T>(IEnumerable<T>, string path)` — async file path
3. `WriteJsonSync<T>(IEnumerable<T>, Stream)` — sync stream

The other 3 overloads (`IAsyncEnumerable` file path, `IEnumerable` async stream, `IAsyncEnumerable` stream) already handled `JsonLinesFormat` correctly.

## Fix
Added `if (options.JsonLinesFormat)` branch to all 3 broken overloads, writing one JSON object per line via `StreamWriter.WriteLine`.

## Tests Added
- 4 tests in `WritersTests.cs`:
  - `WriteJson_JsonLinesFormat_IEnumerable_FilePath_ProducesNDJSON`
  - `WriteJson_JsonLinesFormat_IAsyncEnumerable_FilePath_ProducesNDJSON`  
  - `WriteJsonSync_JsonLinesFormat_FilePath_ProducesNDJSON`
  - `WriteJson_JsonLinesFormat_Stream_ProducesNDJSON`

## Discovered By
Audit Report v4 (February 2026)
